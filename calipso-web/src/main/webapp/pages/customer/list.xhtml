<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/templates/layout.xhtml">

    <ui:define name="title">Liste des Customers</ui:define>

    <ui:define name="content">
        <h:form id="customerForm">

            <!-- Bouton Ajouter -->
            <p:commandButton value="Add Customer" icon="pi pi-plus" 
                             actionListener="#{customerController.prepareCreate}" 
                             update="customerForm"
                             oncomplete="PF('customerDialog').show();"/>
            
            <p:spacer height="10"/>

            <!-- DataTable -->
            <p:dataTable id="customerTable" var="customer" value="#{customerController.customers}" 
                         paginator="true" rows="10" 
                         selection="#{customerController.selectedCustomer}" 
                         selectionMode="single" 
                         rowKey="#{customer.id}" 
                         styleClass="p-datatable-gridlines">

                <p:column headerText="ID">
                    <h:outputText value="#{customer.id}" />
                </p:column>

                <p:column headerText="PrÃ©nom">
                    <h:outputText value="#{customer.firstname}" />
                </p:column>

                <p:column headerText="Nom">
                    <h:outputText value="#{customer.lastname}" />
                </p:column>
                
                <p:column headerText="Email">
                    <h:outputText value="#{customer.email}" />
                </p:column>

                <p:column headerText="Actions" style="width:150px">
                    <p:commandButton icon="pi pi-pencil" title="Edit"
                                     actionListener="#{customerController.prepareEdit(customer)}" 
                                     update="customerForm"
                                     oncomplete="PF('customerDialog').show();"/>
                    
                    <p:commandButton icon="pi pi-trash" title="Delete"
                                     actionListener="#{customerController.deleteCustomer(customer)}" 
                                     update="customerTable"
                                     process="@this"
                                     styleClass="p-button-danger"/>
                </p:column>

            </p:dataTable>

            <!-- Dialog Add / Edit -->
            <p:dialog id="customerDialog" header="#{customerController.dialogTitle}" 
                      widgetVar="customerDialog" modal="true" resizable="false">

                <h:panelGrid columns="2" cellpadding="5">
                    <h:outputLabel for="lastname" value="Nom:"/>
                    <p:inputText id="lastname" value="#{customerController.selectedCustomer.lastname}" required="true"/>
                    
                    <h:outputLabel for="firstname" value="PrÃ©nom:"/>
                    <p:inputText id="firstname" value="#{customerController.selectedCustomer.firstname}" required="true"/>

                    <h:outputLabel for="email" value="Email:"/>
                    <p:inputText id="email" value="#{customerController.selectedCustomer.email}" required="true"/>
                </h:panelGrid>

                <p:separator/>

                <p:commandButton value="Save" 
                                 actionListener="#{customerController.saveCustomer}" 
                                 update="customerTable"
                                 oncomplete="PF('customerDialog').hide();"/>
                <p:commandButton value="Cancel" onclick="PF('customerDialog').hide();" type="button"/>
            </p:dialog>

        </h:form>
    </ui:define>
</ui:composition>
